name: BTC Daily Briefing

on:
  schedule:
    # 매일 00:00 UTC = 09:00 KST
    - cron: '0 0 * * *'
  workflow_dispatch: # 수동 실행 가능

permissions:
  contents: read
  issues: write
  id-token: write  # OIDC 토큰 발급 필수

jobs:
  briefing:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run BTC Briefing
        uses: anthropics/claude-code-action@v1
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
          prompt: |
            비트코인 일일 브리핑을 생성하고 Slack으로 전송해줘.

            1. 웹 검색으로 현재 BTC 가격, 24h/7d 변동률 수집
            2. 주요 뉴스 및 시장 심리 분석
            3. 기술적 분석 요약 (지지/저항, 추세)
            4. 오늘의 전망 작성
            5. Slack MCP로 DM 전송

            리포트는 한국어로, 간결하게 작성.
            마지막에 "투자 조언이 아님" 면책 문구 포함.